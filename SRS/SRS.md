# 运动与血糖SRS
## 1. 导言
### 1.1目的
本文档规定的软件需求适用于以下产品：

**产品名称**：糖小智

**修订或发布编号**：v1.1

本文档旨在满足不同读者类型的需求，以确保各方理解和满足项目要求。

#### 开发人员
关注内容：技术实现、系统架构、数据集成

期望信息：详细的技术规格、接口定义、数据库设计

#### 项目经理
关注内容：项目进度、资源分配、风险管理

期望信息：项目计划、需求优先级、风险评估

#### 营销人员
关注内容：产品特性、市场竞争力

期望信息：产品功能概述、目标用户、市场定位

#### 用户
关注内容：产品功能、用户体验

期望信息：用户手册、功能介绍、界面设计

#### 文档编写人员
关注内容：文档结构、术语表

期望信息：文档模板、术语表
### 1.2文档约定
标题和子标题：
所有主标题使用三号字体，并采用粗体格式。
子标题使用四号字体，并采用粗体格式。

关键术语：
在文档附录A部分提供术语清单，并进行解释。
### 1.3适用人群和阅读建议
适用人群：开发人员、项目经理、营销人员、用户、文档编写人员。

建议开发人员阅读本文档的第4部分——外部接口需求、附录B——分析模型。

建议项目经理阅读本文档的第2部分——总体描述、第4部分——外部接口需求、第5部分——其它非功能需求、附录B——分析模型。

建议营销人员阅读本文档的第2部分——总体描述。

建议用户阅读本文档的第2部分——总体描述。

建议文档编写人员阅读本文档的目录部分、第1部分——导言、附录A——术语表。
### 1.4项目范围
糖小智项目涉及开发一款主要帮助广大2型糖尿病患者通过运动控制血糖，进而降低死亡风险的APP。糖小智APP的设计与医院和医疗保健机构的目标保持一致，为糖尿病患者提供更实时、更智能的血糖监测与运动管理。通过提供高效的血糖监测与运动管理工具，糖小智APP支持糖尿病治疗的数字化转型。

详细的愿景和范围内容可在本文档目录2.2产品愿景中找到，此处不再重复。

本版本的糖小智APP将包含以下主要功能：
血糖的实时监测
血糖历史记录的查看
运动信息的实时展示
运动历史记录的查看
运动方案的推荐
个人健康档案的记录与查看
对用户血糖偏低/偏高事件的报警
### 1.5参考文献
本文档参考的
- [**软件需求规格说明（SRS）模板**](https://www.softwarereqs.com/files/Software%20Requirements%20Specification%20Template.docx)


- [**《2021全球糖尿病地图》**](https://diabetesatlas.org/atlas/tenth-edition/)


- **《中国糖尿病地图》**
  

中国疾病预防控制中心慢性非传染性疾病预防控制中心吴静教授与郭立新教授作为共同主编，联合国内内分泌、慢病疾控及流行病学等领域的著名专家学者，共同编写；由人民卫生出版社出版发行

- [**《关于实施健康中国行动的意见》**](https://www.gov.cn/zhengce/content/2019-07/15/content_5409492.htm)


- [**《中国2型糖尿病防治指南（2020年版》**](https://med.wanfangdata.com.cn/Paper/Detail?id=PeriodicalPaper_zhnfmdx202104009)

- [**《中国糖尿病运动治疗指南》**](https://down.jctnb.org.cn/uploads/download_content/2019/06/15d102b5c39564.pdf)
## 2. 总体描述
### 2.1产品愿景
  健康中国的目标是到2030年全民健康素养水平大幅提升，健康生活方式基本普及，居民主要健康影响因素得到有效控制，因重大慢性病导致的过早死亡率明显降低，人均健康预期寿命得到较大提高，健康公平基本实现。

  糖尿病是四类主要慢性病之一。根据国际糖尿病联盟（IDF）发布的《2021全球糖尿病地图》显示，2021年全球成年糖尿病患者人数达到5.37亿，其中中国患者总人数最多，约为1.4亿。而根据WHO诊断标准，糖尿病人群中2型糖尿病占90%以上，其他种类糖尿病较为罕见。2022年，中国疾病预防控制中心慢性非传染性疾病预防控制中心和北京医院联合发布的《中国糖尿病地图》显示，我国2型糖尿病的患病率自1979年以来呈总体上升趋势，且仍处在一个快速增长阶段，短期内不会出现平台期或者下降。除此之外，我国糖尿病的疾病知晓率、治疗率、控制率仍处于较低水平，疾病防治形势极为严峻。2018年中国慢性病及危险因素监测结果显示，我国18岁及以上成年人糖尿病知晓率仅为38.0%，治疗率为34.1%，控制率仅为33.1%。中国疾控中心慢病中心代谢病防控室的负责人李剑虹研究员表示，想要改变这个状况，需要我们整个医疗卫生体系的通力合作，切实建立医防融合和医防协同的有效工作机制并有效运行。

  《中国2型糖尿病防治指南（2020年版）》中指出，运动锻炼在2型糖尿病患者的综合管理中占重要地位。规律运动可增加胰岛素敏感性、改善体成分及生活质量，有助于控制血糖、减少心血管危险因素，而且对糖尿病高危人群一级预防效果显著。流行病学研究结果显示，规律运动8周以上可将2型糖尿病患者糖化血红蛋白降低0.66%，经常运动的糖尿病患者死亡风险显著降低。同时，2型糖尿病患者的运动处方的制定需专业人士指导，也需遵循个体化原则。运动项目要与患者的年龄、病情、喜好及身体承受能力相适应,并定期评估,适时调整运动计划。

  基于以上情况，我们以实时血糖仪和运动手表为基础，意图开发主要帮助广大2型糖尿病患者通过运动控制血糖，进而降低死亡风险的APP。
### 2.2产品特性
#### 1. 实时血糖监测
- 实时数据传输：
实时收集和传输用户的血糖数据，确保用户随时了解自己的血糖水平。
- 数据可视化：
提供直观的图表和趋势分析，帮助用户了解血糖水平的变化趋势，并提供历史记录查询功能。
> [!CAUTION]
> 预警和提醒：
基于用户的目标血糖范围，实时监测并发送提醒，帮助用户及时采取措施控制血糖。

#### 2. 运动监测和建议
- 运动记录：
记录用户的运动活动，包括类型、时长等，建立个性化的运动档案。
- 运动方案：
根据用户的血糖水平、身体状况和喜好，生成个性化的运方案，帮助用户进行有针对性的运动。
- 定期评估和调整：
定期评估用户的运动计划效果，根据实际情况提醒用户调整运动方案，确保持续有效的血糖控制。
### 2.3用户类型和特征
详细的用户类型和特征可在本文档[目录1.1](#11目的)目的中找到，此处不再重复。
### 2.4操作环境
#### 硬件平台、操作系统及其版本：

采用uni-app开发，它是 一个使用Vue.js开发所有前端应用的框架，开发者编写一套代码，可发布到iOS、Android、Web（响应式）、以及各种小程序（微信/支付宝/百度/头条/飞书/QQ/快手/钉钉/淘宝）、快应用等多个平台。

#### 用户、服务器和数据库的地理位置：

- 用户分布：中国境内
- 服务器位置：数据中心位于上海、深圳和北京，以提供全国范围内的高可用性。
- 数据库位置：主数据库在上海，备份数据库在杭州。

#### 托管相关数据库、服务器和网站的组织:

- 数据库托管组织：阿里云RDS（Relational Database Service）
- 服务器托管组织：阿里云的ECS（Elastic Compute Service）
- 网站托管组织：阿里云的ECS、Web应用托管服务
- 代码托管与CI/CD组织： Github
- 镜像托管网站：DockerHub

#### 必须与之和谐共存的其他软件组件或应用程序：

- Web服务器：Apache 2.4
- 应用服务器：Tomcat 9
- 数据库管理系统：MySQL 5.7.44-log
- 框架：Spring Boot 2.5
- 前端框架：Vue3

### 2.5设计和实施约束
国标GB/T 35273-2017《个人信息安全规范》要求了隐私政策需要单独成文，因此需要在APP中加入隐私政策的内容，并提供链接供用户查阅，用户需明确知晓并同意隐私政策后才可继续使用APP。用户参加运动必然面临一些不可抗的风险，因此需要按照《合同法》的要求，在APP中加入合理的免责声明，用户需明确知晓并同意免责声明后才可使用运动方案推荐功能。

本APP规定使用MYSQL作为数据库，通过MyBatis框架把数据库的各个表映射成JAVA中的实体类，以及通过mapper来对数据库进行增删改查。规定后端开发人员使用Spring Boot框架，前端开发人员使用VUE框架和ant design mobile组件库。规定通过apifox来管理各个接口，通过nginx来转发前后端之间的HTTP请求。

本APP还需要与雅培瞬感血糖仪和华为运动手表进行连接，因此开发人员要了解并遵循二者的API规范，确保数据交换和集成的顺利进行。
### 2.6用户文档
#### 1.介绍
糖小智是一个以实时血糖仪和运动手表为基础，主要意图为帮助广大2型糖尿病患者通过运动控制血糖，进而降低死亡风险的APP。欢迎您选择糖小智作为您的控糖助手，本文档将帮助您熟悉和使用我们的系统。

#### 2.快速入门
安装指南：请从您手机上官方的应用商店下载糖小智APP。

启动和登录：在安装完成后，启动应用程序并使用您的账户登录。如果您未注册账户，请先注册。

#### 3.主要功能
- 实时监测您的血糖
- 查看您的血糖历史记录
- 实时展示您的运动信息
- 查看您的运动历史记录
- 为您推荐合适的运动方案
- 记录与查看您的个人健康档案
- 对您的血糖偏低/偏高事件的报警
> [!NOTE]
> #### 4.常见问题解答
Q：我如何通过糖小智APP实时监测血糖？

A：请您先购买一款雅培瞬感血糖仪，在APP上使血糖仪和您的手机建立连接，这样就可以实时查看您的血糖了。
### 2.7假设和依赖
#### 1. 第三方组件的可用性：
假设： 我们假设计划使用的特定第三方库或组件在项目开始时将处于可用状态。
依赖关系： 如果该组件不可用、不稳定或存在延迟，项目的开发和进度可能会受到影响。我们可能需要考虑备用组件或实施替代方案。

#### 2. 外部服务的性能和稳定性：
假设： 我们假设依赖的外部服务将提供足够的性能和稳定性。
依赖关系： 如果外部服务性能不足或不稳定，可能会影响到我们的应用程序。我们需要定义相应的容错机制或备用计划。

#### 3. 数据库系统的可靠性：
假设： 我们假设所选的数据库管理系统将保持高可靠性，并能满足系统的数据存储需求。
依赖关系： 如果数据库系统发生故障或无法满足性能需求，可能需要实施紧急修复或考虑数据库迁移。

#### 4. 开发环境的稳定性：
假设： 我们假设开发和测试环境将提供足够的稳定性，以反映最终部署环境。
依赖关系： 如果开发环境与生产环境存在差异或不稳定，可能会导致在生产中出现未预期的问题。我们需要确保环境之间的一致性。
### 3. 系统特性
#### 3.1血糖监测与记录
**用例**：每隔15分钟记录一次血糖，生成当日血糖走势图，并据此给出健康贴士。走势图中有高血糖与低血糖的阈值，可以起到预警的作用。还可以查看历史日、周、月的血糖图或者表格。

**迭代**：[蔡逸轩，12月13日](https://github.com/SoftwareEngineeringMedical/.github/commit/70ff1c1)

**主要参与者**：病人

**情景目标**：用户戴上血糖仪后，必须能够查看每15分钟一次的血糖记录。

**前提条件**：用户正确佩戴血糖仪，血糖仪与手机APP的NFC连接成功；必须获得正确的账号和密码。

**触发器**：病人决定查看当日或者是之前的血糖记录。

**场景**：

1. 病人登录“糖小智”手机APP。

2. 病人输入他的账号。

3. 病人输入密码。

4. 系统显示主界面。

5. 病人选择“血糖日历”。

6. 病人从时间跨度月、周、日中选择一项。

7. 病人选择一个特定的时间段。

8. 系统显示历史血糖的最高最低值的趋势图与血糖情况总结。

9. 病人选择一个时间点并双手方法查看。
> [!CAUTION]
> **异常处理：**

1. 账号或密码不正确或不被确认——参见用例“确认账号与密码”。

2. 病人没有正确佩戴血糖仪或血糖仪与APP没有连接成功——系统显示相应的错误消息，并提醒用户重新佩戴血糖仪。

3. 病人在“我的血糖数据”界面选择“文本”——系统显示历史时间段内的血糖值表格。

4. 病人在“我的血糖数据”界面选择“选择”——回到6，病人再次从时间跨度中选择一项。

5. 病人在“我的血糖数据”界面选择“回今天”——系统显示当前血糖的趋势图与提示。

6. 病人在“我的血糖数据”界面点击左/右箭头——查看前/后一个时间段的血糖记录。

7. 系统不能成功获取血糖——记录为缺失/暂时与上一次记录相同/等待下一次血糖出现后进行拟合并提示用户。（TBD）

8. 用户选择日期错误(当前日期之后或者日期过早)——提示用户选择日期错误，如果是日期过早，那么就会显示最早的一次或一组记录；如果是当前日期之后，那么就显示今天对应的日/周/月记录。

9. 选择无数据日期——当日用户并未检测血糖，提示用户无数据。

10. 用户突然中断血糖监测——系统记录中断事件并显示在图标上。

**优先级**：高。

**何时有效**：第二个增量。

**使用频率**：高。

**参与者的连接渠道**：通过安卓手机的APP和互联网登录“糖小智”。

**次要参与者**：血糖仪，系统管理员。

**次要参与者的连接渠道**：

1. 血糖仪：基于NFC协议与安卓手机互联。
   
2. 系统管理员：通过服务器连接到部署的站点。

**未解决的问题：**

1. 如果短暂失联如何提醒病人？
   
2. 产生海量的历史数据后，历史数据应该保留哪些？删除哪些？
   
3. 用什么机制确认获取的血糖数据全部处于有效范围（即使是异常的病人也不可能得到的数据应该剔除）？
   
#### 3.2运动方案生成
**用例**：系统根据病人的自身情况向病人推荐个性化的运动方案。

**迭代**：[胡云韬，11月29日](https://github.com/SoftwareEngineeringMedical/.github/commit/d0c634v)

**主要参与者**：病人

**情景目标**：用户进入了“我要运动界面”，系统根据用户情况智能生成运动方案。

**前提条件**：用户正确填写个人档案，并正确回答3轮问答。

**触发器**：病人进入了“我要运动”界面或在运动方案界面点击“重新选择”。

**场景**：

1. 系统检测用户是否有现存的运动计划。
2. 如果用户没有现存计划，或计划已过期，或计划不符合期望，系统获取用户的健康档案。
3. 展示手动填写或自动生成选项，用户选择自动生成。
4. 用户选择自动生成计划。
5. 系统生成多个计划，用户选择其中一个。
6. 新计划添加到日程。

> [!CAUTION]
> **异常处理：**
1.	手动填写计划合理性检测异常——系统会提供清晰的错误信息，指导用户检查并修改不合理的计划。系统还可以提供一些建议来改进计划。
2.	自动生成计划不符合用户预期——提供用户评估生成的计划的选项，并允许用户选择或调整计划。系统可以收集反馈以改进自动生成计划的算法。（TBD）
3.	用户选择“手动填写”——系统遵循用户选择手动填写计划；用户完成填写后，系统检测计划的合理性；新计划添加到日程的流程。
4.	用户选择“修改方案”——用户选择手动填写计划；用户完成填写后，系统检测计划的合理性；新计划添加到日程。

**优先级**：低。

**何时有效**：第三个增量。

**使用频率**：中。

**参与者的连接渠道**：通过安卓手机的APP和互联网登录“糖小智”。

**次要参与者**：系统管理员。

**次要参与者的连接渠道**：
1. 系统管理员：通过服务器连接到部署的站点。

**未解决的问题**：
无。

#### 3.3运动记录
**用例**：系统根据病人的自身情况向病人推荐个性化的运动方案，病人在符合条件后，可以进行运动。

**迭代**：[蔡逸轩，12月14日，UI设计](https://github.com/SoftwareEngineeringMedical/.github/commit/69fa11d)
[胡云韬，12月15日，活动图设计](https://github.com/SoftwareEngineeringMedical/.github/commit/a1d501)

**主要参与者**：病人

**情景目标**：用户戴上运动手表后，在运动期间，每3分钟可以查看一次心率。

**前提条件**：用户正确佩戴运动手表，运动手表与手机APP的NFC连接成功；必须获得正确的账号和密码。

**触发器**：病人准备运动。

**场景**：

1. 病人登录“糖小智”手机APP。
2. 病人输入他的账号。
3. 病人输入密码。
4. 系统显示主界面。
5. 病人选择“我要运动”。
6. 在“请再三确认有没有以下症状”，病人没有勾选任何症状。
7. 在“第二步——请如实回答下列问题”，系统得出病人的基本情况适合运动。
8. 在“第三步——请如实回答下列问题”，系统得出病人近期健康状况良好，适合运动。
9. 病人选择一种推荐的运动方案，并勾选“我已知晓并同意”。
10. 用户点击确认，并点击“开始运动”。
11. 显示实时运动界面，实时记录运动情况与心率。
12. 运动结束后，在“运动方案”界面上，显示当前运动方案用户“已完成”。

> [!CAUTION]
> **异常处理：**
1. 在运动前的散布确认环节不符合前提条件——展示前提条件并提示哪些条件不符，给出相应的建议。
2. 运动途中高血糖或低血糖——系统发出警报，参考用例“血糖警报”。
3. 超出运动计划要求的频率、方式、强度等等——系统提醒用户合理计划。
4. 无法连接运动手表——提醒用户多尝试连接几次运动手表。
5. 病人在运动过程中选择”停止”——终止本次运动与相关心率的记录，此次运动未完成。
6. 病人对生成的运动方案不满意，点击“重新选择”——回到步骤9，参考用例“运动方案生成”。

**优先级**：高。

**何时有效**：第一个增量。

**使用频率**：中。

**参与者的连接渠道**：通过安卓手机的APP和互联网登录“糖小智”。

**次要参与者**：血糖仪，运动手表，系统管理员。

**次要参与者的连接渠道**：
1. 血糖仪与运动手表：基于NFC协议与安卓手机互联。
2. 系统管理员：通过服务器连接到部署的站点。

**未解决的问题**：
1. 用户无法临时暂停运动。

#### 3.4血糖警报
**用例**：运动过程中的血糖警报。

**迭代**：[胡云韬，11月29日](https://github.com/SoftwareEngineeringMedical/.github/commit/d0c634)

**主要参与者**：病人

**情景目标**：用户在运动时突发高血糖或低血糖。

**前提条件**：系统处于“正在运动”界面，系统检测到高血糖或低血糖。 

**触发器**：系统在“正在运动”界面的血糖值异常。

**场景**：

1. 系统持续发出警报。

2. 用户有高血压，提醒停止运动并喝水。

3. 在接下来的几天里设置用户的状态为“不适合运动”。

> [!CAUTION]
> **异常处理：**

1. 用户有低血糖——提醒补充葡萄糖，在运动后进行自我检测，系统记录血糖与心率。

**优先级**：低。

**何时有效**：第四个增量。

**使用频率**：低。

**参与者的连接渠道**：通过安卓手机的APP和互联网登录“糖小智”。

**次要参与者**：系统管理员。

**次要参与者的连接渠道**：
1. 系统管理员：通过服务器连接到部署的站点。

**未解决的问题**：
       无。


### 4. 外部接口需求
#### 4.1用户接口
通过在首页点击“血糖日历”，就可以进入到血糖日历的首页，我们将实时血糖显示在了首页，这样有助于及时提醒用户。

![image](https://github.com/SoftwareEngineeringMedical/.github/assets/103842499/7864d7df-da0a-44db-a58e-1fdb34d20225)

通过导航栏可以切换到“我的”界面，在我的界面用户可以编辑自己的健康档案，以供后续查看。

![image](https://github.com/SoftwareEngineeringMedical/.github/assets/103842499/e3575a12-6388-4813-bc06-0ebd71571257)

“运动历史”界面展示了用户近一月、近一周、近一天的运动数据和总运动数据。还可以查看单个运动的运动数据。
可以在“我要运动”界面选择运动方案，也可以开始运动，关于运动方案的筛选前面已经说过了，在运动实时界面显示了用户的用时、速度等信息。

![image](https://github.com/SoftwareEngineeringMedical/.github/assets/103842499/2001c6bf-eb43-4fe5-b3ad-ebc9d8d140d2)

“血糖日历”界面展示了实时血糖和血糖历史记录。实时血糖界面的主题是血糖在一天内的趋势图，图上用手指靠近任意一点，就可以显示该点血糖的详细信息，如图。阴影部分表示运动，折线图下方是当前血糖值，通过红黄蓝来提醒用户是正常、低还是高血糖。血糖值下方是小贴士。

![image](https://github.com/SoftwareEngineeringMedical/.github/assets/103842499/c9d009af-211e-4f3d-b92e-8756de217a3d)

对于血糖记录还提供了按日、周、月等跨度查看的选择。

![image](https://github.com/SoftwareEngineeringMedical/.github/assets/103842499/4f552a47-8153-4fdc-aa8c-6d3c9b061e50)

在血糖页面中采用了尽量多的跳转按钮，例如在查询血糖的历史记录时，可以点击“选择”再次选择查看的粒度与时间，可以点击“回今天”立马跳转到当前数据，导航关系中适当的冗余有助于增强用户对系统的“掌控感”。

![image](https://github.com/SoftwareEngineeringMedical/.github/assets/103842499/f01844c2-38bf-4dcb-a88d-616b9d6556bb)
> [!IMPORTANT]
> 本系统的UI设计遵循了“把控制权交给用户”与“减轻用户的记忆负担”等原则。

#### 4.2硬件接口
用户通过组装传感器并将其贴敷到身上，打开本系统的APP，安卓手机需开启NFC功能。苹果手机用顶部贴近传感器激活，安卓手机用背部靠近传感器激活.

#### 4.3软件接口
| ***功能***                       | ***Restful API***                             | ***Java参数(输入)***     | ***Java函数返回值*** |
| ------------------------------------ | ------------------------------------------------- | ---------------------------- | ------------------------ |
| ***注册***                       | POST /user                                        | User                         | Integer(user_id)         |
| ***注销***                       | DELETE /user/{id}                                 | Integer(user_id)             | void                     |
| ***登录***                       | PUT /user/{id}                                    | Integer(user_id),User        | Boolean                  |
| ***查看用户个人信息***           | GET /user/{id}                                    | Integer(user_id)             | User                     |
| ***获取血糖数据并记录***         | POST /glycemia/{user_id}                          | Integer(user_id),Glycemia    | Boolean                  |
| ***实时血糖数据的查询***         | GET /glycemia/{user_id}                           | Integer(user_id)             | List<Glycemia>           |
| ***查看运动计划***               | GET /scenario/{user_id}                           | Integer(user_id)             | Scenario                 |
| ***创建/修改运动计划***          | PUT /scenario/{user_id}                           | Integer(user_id),Scenario    | Boolean                  |
| ***删除当前运动计划***           | DELETE /scenario/{user_id}                        | Integer(user_id)             | Void                     |
| ***查询是否符合运动的前提条件*** | GET /profile/{user_id}GET /complication/{user_id} | Integer(user_id)             | Boolean                  |
| ***记录运动***                   | POST /exercise/{user_id}                          | Integer(user_id),Exercise    | Boolean                  |
| ***查看当日运动***               | GET /exercise/{user_id}?date={Date}               | Integer(user_id),Date        | List<Exercise>           |
| ***侦测实时心率***               | GET /heartrate/{user_id}                          | Integer(user_id)             | Heartrate                |
| ***查看当日血糖***               | GET /glycemia/{user_id}?Date={Date}               | Integer(user_id),Date        | List<Glycemia>           |
| ***检查身体***                   | POST /examination/{user_id}                       | Integer(user_id),Examination | Boolean                  |
| ***查看体检结果***               | GET /examination/{user_id}                        | Integer(user_id)             | Examination              |
#### 4.4通信接口
##### 安卓APP与后端(Spring Boot)之间的通信：
1. 安卓APP与后端之间通常使用HTTP/HTTPS协议进行通信。
2. 安卓APP通过设备的网络连接（例如Wi-Fi、移动数据）建立与后端服务器的TCP连接。
3. 使用HTTP请求（GET、POST、PUT等）发送数据到后端，后端通过HTTP响应返回数据。

##### 后端(Spring Boot)与MySQL数据库之间的通信：
1. 后端通过JDBC（Java Database Connectivity）等数据库连接方式，建立与MySQL数据库的TCP连接。
2. 使用SQL协议执行数据库查询、更新等操作。

##### 后端(Spring Boot)与Nginx之间的通信：
1. Nginx作为反向代理服务器，接收来自客户端（包括安卓APP）的HTTP请求。
2. Nginx通过配置的代理规则将请求转发给后端的Spring Boot服务。
3. Nginx和后端之间通过TCP连接进行通信，可以使用HTTP或FastCGI等协议。

##### Docker容器之间的通信：
1. 安卓APP与后端、后端与MySQL数据库之间的通信，都通过Docker网络进行。Docker容器可以通过在同一网络中来建立相互通信。
2. 使用Docker的网络命名空间，容器可以通过容器名称或IP地址相互访问。
3. 在Docker Compose或其他编排工具中定义容器间的网络关系。
## 5. 其他非功能需求
### 5.1性能需求
#### 1.精度要求
根据市场调研，我们发现血糖仪测出的数据基本是保留小数点后一位。

我们需要向用户显示每天的最高血糖、最低血糖、平均血糖、各个时刻的血糖数据，这些数据都存储为decimal(3,1)类型，它可以存储最多 3 位数字，其中小数点后有 1 位。DECIMAL 数据类型可以提供精确的小数值存储，避免了浮点数类型可能遇到的精度损失问题。而且使用 DECIMAL(3,1) 可以确保数据库中的数据具有统一的格式和精度，方便进行数据分析和处理。

我们需要向用户显示心率数据，因为心率是整型的，所以心率相关的数据都取成整型的。

在提供运动方案以及记录运动情况的时候，我们会具体到在哪个时刻开始运动，因此会使用DATETIME或者TIME类型来记录起始时间。

#### 2.时间特性要求
- 对于本平台，在95%的情况下，一般响应时间不超过2000ms，高峰时段不超过4000ms；
- 在网络通畅时，我们需要从数据库获取数据并更新血糖记录界面，界面的刷新时间应该不超过5000ms
- 在非高峰时间使用“运动方案推荐”功能，可以在4s内得到推荐结果
- 在查看历史血糖数据和历史运动数据的时候，响应时间不超过2000ms（我们有做专门的视图，所以应该能较快地进行响应）

#### 3.输入输出要求
按照功能，归纳出本系统有以下几部分需要进行输入：
（1）用户修改个人信息

（2）修改病人档案

（3）上传体检报告信息

（4）创建和修改运动方案





这里对其中比较重要的两部分列出了具体的输入输出要求：

（1）用户修改病人档案

![image](https://github.com/SoftwareEngineeringMedical/.github/assets/103842499/21873268-52c2-4345-be82-c500724e3881)


（2）创建和修改运动方案

![image](https://github.com/SoftwareEngineeringMedical/.github/assets/103842499/e5a785b1-ed4c-40aa-a5d7-b2e40ed21851)


### 5.2安全需求
描述：用户对系统所应具备的故障处理能力、处理方式及故障后的系统恢复、数据恢复等要求，对系统防止机密数据被非法侵入、修改及丢失的要求。

本项目旨在为广大糖尿病患者提供便利，帮助他们改善生活方式，助力他们维持正常的血糖，涉及到大量个人身体体征、疾病史等隐私数据的收集和展示，因此需对本平台的安全性、故障恢复能力、保密性和数据保护提出较高要求，以下将对这些安全性及保密要求作详细分析。
> [!WARNING]
> #### 1. 平台应具备的故障处理需求

（1）页面信息展示失败故障需求处理表

| 故障名称     | 页面信息展示失败                                             |
| ------------ | ------------------------------------------------------------ |
| 处理方式     | 前端：页面展示错误提示信息，提示用户进行等待后端： 保证事务处理的原子性，尝试重新连接数据库 |
| 数据恢复要求 | 无                                                           |
| 系统恢复要求 | 在10000ms内恢复系统                                          |

（2）运动方案推荐功能长时间未响应故障需求处理表

| 故障名称     | 运动方案推荐功能长时间未响应                                 |
| ------------ | ------------------------------------------------------------ |
| 处理方式     | 前端：页面展示错误提示信息，提示用户进行等待，保持用户输入的数据不丢失，尝试重新调用API请求后端： 增加异常捕获机制，当出现异常情况时及时向前端返回错误信息。返回相应状态码，等待前端重新发出请求。 |
| 数据恢复要求 | 要恢复用户提交表单前填写的所有内容                           |
| 系统恢复要求 | 1000ms内系统恢复至用户个性化信息已填写完毕、待生成运动方案的页面 |


（3）硬件连接失败故障需求处理表

| 故障名称     | 硬件连接失败（例如，无法连接到运动手表、无法连接到血糖仪）   |
| ------------ | ------------------------------------------------------------ |
| 处理方式     | 前端：页面展示连接失败信息，并提示用户该如何进行连接后端：记录中断事件，返回相应状态码，等待重新连接到硬件 |
| 数据恢复要求 | 将数据恢复到硬件断开连接之前的状态                           |
| 系统恢复要求 | 在5000ms内恢复系统并在前端显示相应提示                       |


#### 2. 权限访问控制需求
为了保护病人信息，本平台需严格权限访问控制，用户只有在经过登录和身份认证后，才能访问自己的病人档案、体检报告、血糖记录等数据。

在未来，系统可能会进行扩展，加入医生、护士、管理员等角色，不同用户具有不同的身份和权限，届时也需要对医生进行身份认证，并且要区别好每个用户具有哪些权限，确保数据的机密性和完整性。

#### 3. 防攻击篡改需求
由于本系统内有大量关于病人既往病史、住址、联系方式等重要隐私数据，因此应具备完善的反爬虫机制，防止被爬导致服务崩溃。对此应采用适当的验证码机制和分流机制。

除此之外，还应能经受来自互联网的一般性恶意攻击。如病毒（包括木马）攻击，口令猜测、黑客入侵等。其中至少99%的攻击需要在10000ms内检测到。

#### 4. 数据库数据的安全性保障
为了防止往数据库中加入错误的数据导致系统故障，我们在数据库中设置了一系列CHECK，在更新表数据的时候，系统会检查更新后的数据行是否满足 CHECK 约束中的限定条件，从而防止错误数据的产生。（如下图所示）

![image](https://github.com/SoftwareEngineeringMedical/.github/assets/103842499/8b9066ed-5b8e-4c86-bceb-688b3ac0e186)



### 5.3保密需求
#### 1. 数据库的保密
数据库中会存储用户的病历等隐私数据，为了避免数据库重要信息暴露的可能性，需要保护好数据库的账号密码，不能将它传到GitHub（如下图所示，我们上传到GitHub的时候没有写下数据库的用户名、密码、URL等）。

![image](https://github.com/SoftwareEngineeringMedical/.github/assets/103842499/f1447ee5-12c2-49ca-a766-59043545498f)

我们还可以通过 GitHub 的 Secrets 功能，在 CI/CD 运行时保证敏感信息的机密性，保障项目的安全性和可靠性。（如下图所示）

![image](https://github.com/SoftwareEngineeringMedical/.github/assets/103842499/e1e815d1-15ef-4764-9072-8c0ef575180e)

这样一来，push代码的时候github就会自动进行Secret Scanning，检查是否有机密信息会被泄露。

#### 2. 检查代码，保证代码的安全性
要在系统上线之前仔细审查代码，避免出现诸如因采用print语句输出信息辅助调试的代码语句遗留而导致敏感信息被暴露在前端之类的情况。此外，应当仔细审查功能逻辑设计，避免在系统的运行过程中，因为逻辑漏洞导致用户的私有信息被其他用户查看。

我们使用了GitHub自带的Security功能来检测代码安全性，该功能可通过对代码库进行扫描，检测出一些常见的安全漏洞和风险，如XSS攻击、SQL注入等（如下图所示）。

SQL注入攻击是一种常见的网络攻击方式，为了防止这种攻击，最常用的方法是使用参数化查询，即将查询条件作为参数传递给查询函数，而不是将查询条件直接构造成SQL语句。这样可以避免恶意输入被解释成SQL语句中的一部分，从而防止SQL注入攻击。

![image](https://github.com/SoftwareEngineeringMedical/.github/assets/103842499/184f4c5e-ab61-4a0e-b56d-fdd97093b210)

#### 3. 当前登录信息的存储
为了保证本系统的安全性，前端每次在登录的过程中将会由后端生成一段token信息，并存储到localStorage中。而当用户的操作涉及到与个人信息有关的时候，后端接收到请求，先检验该Token信息是否过期，如果过期或者该用户无权限进行该操作，则设置errorCode为400。反之，将当前token信息放在request的头部（headers），并返回该请求的结果。前端接收到返回值后，如果发现errorCode为400，将会跳转到首页，并提醒登录过期。如果token没有问题，就正常进行数据处理和页面展示。
### 5.4软件质量属性
#### 1. 易使用性
由于本系统主要的目的是面向普通用户使用，因此易用性是系统比较重要的一个要求。我们为用户提供富文本框输入方式，方便用户输入。在用户将APP与设备连接时，我们会提供充分的提示以帮助初次使用的用户。为方便用户就诊，我们在系统中设置了多个表格来存储用户的病人档案、并发症情况等，可以让医生更快地明确病人情况并进行开药，节约效率。

在血糖记录的子系统中，我们会提供一系列图像给用户以展示血糖变化数据，为了方便用户理解，我们会进行简要的概括和归纳。为方便医生查看用户过去的血糖数据，我们会在数据库中保留每月、每周的概括性数据。

在运动子系统中，为了方便推荐运动方案，我们会提出几个简单、容易分辨的选择题来让用户进行选择，从而建立较明确的用户画像。为了帮助用户养成好的运动习惯，我们会提供一系列报表，用户可以方便地查看自己过去的运动情况。我们也提供了一个日程表视图，可以帮助用户查看运动方案，查看自己哪几天、哪些时刻应该运动。

#### 2. 可维护性
我们采用层次架构，控制器层负责处理各个URL请求，并调用相应的服务接口来完成具体的业务逻辑。服务层提供系统各项服务的接口，从而实现模块化设计，使得服务的功能易于管理和维护。我们使用了MyBatis框架，将SQL语句与Java代码解耦，并在Mapper层进行接口与SQL语句的映射，进一步提高了代码的可维护性和可读性。我们使用了ORM映射，将数据库的表自动化地映射到了各个实体，如果需要修改数据库，可以再次执行自动化命令对代码进行更新。

综上所述，层次架构有较好的可维护性，并且系统的前后端代码应保证开放-封闭原则，在进行业务的扩充和业务的修改时尽量保证现有函数和接口无需进行大幅度修改。

#### 3. 美观性
通过原型设计图，可以看出我们的UI非常简洁明了，而且保持了比较统一的色调。我们所有的组件都基于vue的element-ui组件进行设计，从而进一步维持了风格的一致性。

糖尿病患者基本是老年人，所以我们将字体设计得比较大、比较老年人友好。

#### 4. 可扩展性
首先，我们设计了若干接口，例如在运动系统中，推荐运动方案时有一个“推荐高强度运动”的接口；在血糖系统中，监测血糖的时候有与血糖仪、运动手表相连的硬件接口。这些接口虽然尚未实现，但未来如果能实现将让项目极大地扩展。

其次，我们预先设计了若干个用户角色，例如医生角色、护士角色、管理员角色，并在需求调研阶段确认了每个角色需要系统提供哪些服务。虽然这些角色相应的客户端还未投入开发，但我们在user表中预留了"role"这个字段，未来如果要进行客户端扩展的话，对现有表将修改较少。

并且，我们考虑到使用平台的可移植性和用户的使用便捷性需求，平台开发的服务平台代码应具有高复用性需求，至少后端代码应易于适应平台的改变。当前我们是使用vue框架搭建的，但后续平台应具备可开发为APP的能力。
## 6. 其他需求
### 1. 隐私协议
除功能性需求和非功能性需求外，本系统还需满足相关的法律需求。每位用户在登录时，需同意用户协议和隐私政策（关键条例做出醒目提示）后才可继续使用该系统，其中用户协议和隐私政策将依据《中华人民共和国网络安全法》撰写。

另外，我们知道用户的病历原则上是保密的，因此无论后续功能如何修改，都不应该在系统中让用户上传自己的病历。

### 2. 可信的服务
该产品包含运动方案推荐功能，虽然组内的开发人员中不包含医学院的学生，但我们应尽量加强与专业医生团队的沟通，应参考推荐的书籍和论文，提供尽量可靠的运动方案推荐。

为防止推荐的运动方案对用户健康有反作用，我们遵照医生的意见，目前只推荐低风险的低强度运动，并会出现若干健康提示以提醒用户注意身体、及时补充糖分。

### 3. 可靠的技术支持
我们的平台需要与相应硬件连接，我们会提供尽量详细的说明，但也难免有用户在努力后仍然无法连接到硬件，因此我们会在页面上显示技术服务热线电话以便用户咨询。
## 附录A：术语表
术语表用于定义项目中使用的专业术语和缩略词的含义，以确保整个团队对术语的理解达成一致。这有助于减少沟通误解，并提高项目文档的清晰度和一致性。

### 1. 糖小智
我们小组和另外两个小组共同加入了赵钦佩老师参与的上海科委“科技创新行动计划”国际科技合作项目， 这是基于饮食、运动，进行深度强化学习的糖尿病个性化精准血糖管理项目。该项目的最终目的是基于糖尿病患者的饮食、运动、用药这三方面， 建立对患者血糖变化的预测模型。 其中我们小组主要负责的是记录患者的运动情况以及血糖变化情况并进行分析，而另一组主要负责的是记录患者的饮食情况并进行分析，还有一个小组负责建立饮食图片数据集。

我们的项目有一个统一的名字：“糖小智”，但我们三组有各自的聚焦点，并独立地进行项目开发。

我们组的“糖小智”主要有：运动、血糖日历、个人中心这三个子系统。

### 2. 运动方案
为提高患者的治疗依从性，帮助用户养成好的运动习惯，从而把血糖控制在较为良好的水平，我们会根据用户画像帮助用户建立运动方案，并提醒用户执行运动计划。

运动方案中包含以下几项内容：开始日期，结束日期，开始时间，持续时间，锻炼频率，运动分类，运动强度。

根据运动方案，系统可以自动生成“日程表”视图，在日程表中显示哪些天、哪些时刻需要运动。

### 3. 一型糖尿病、二型糖尿病以及妊娠糖尿病
一型糖尿病是一种自身免疫性疾病，其主要特征是胰岛素的分泌不足或完全缺乏，通常需要终身注射胰岛素来管理血糖水平。

二型糖尿病是一种慢性代谢性疾病，其特征是身体对胰岛素的使用效率降低或胰岛素的分泌减少。二型糖尿病通常与生活方式因素（如不健康饮食、缺乏运动等）和遗传因素有关。初期可以通过改善生活方式来管理血糖，但在某些情况下可能需要口服药物或胰岛素注射。数据显示90%以上的糖尿病患者都是二型糖尿病。

妊娠糖尿病是指在妊娠期间发生的一种暂时性糖尿病。它通常在妊娠后期出现，并且在妊娠结束后通常会自行消失。
## 附录B：分析模型
### 一、用例图分析
#### 1.1 总用例图及其分析

![image](https://github.com/SoftwareEngineeringMedical/.github/assets/103842499/62bc92db-4d22-433d-900f-af2cd7b4569d)

（1）参与者

**_用户_**：使用系统的个人用户，可以选择运动方案、查看运动历史、记录运动情况、查看血糖变化情况和编辑个人信息。

**_运动手表_**：一种智能手表设备，可以与系统交互，提供功能如查看运动历史和记录运动情况等。

**_血糖仪_**：一种测量血糖水平的设备，可以与系统交互，提供功能如查看血糖水平等。

（2）用例

系统一共有五个用例，分别是选择运动方案用例、查看运动历史用例、记录运动情况用例、查看血糖变化情况用例、编辑个人信息用例。

- 选择运动方案：用户可以从系统提供的运动方案中选择适合自己的方案。
- 查看运动历史：用户可以查看之前记录的运动历史，包括日期、运动类型和持续时间等信息。
- 记录运动情况：用户可以记录当前的运动情况，包括日期、运动类型、持续时间和消耗热量等信息。
- 查看血糖变化情况：用户可以查看自己的血糖变化情况，包括不同时间点的血糖水平。
- 编辑个人信息：用户可以编辑个人信息，如性别、年龄、身高、体重等。

（3）关联关系

用户与选择运动方案、查看运动历史、记录运动情况、查看血糖变化情况以及编辑个人信息之间存在关联关系，表示用户可以执行这些用例。

运动手表与查看运动历史和记录运动情况之间存在关联关系，表示运动手表可以执行这些用例。

血糖仪与查看血糖变化情况之间存在关联关系，表示血糖仪可以执行这个用例。

#### 1.2 运动子系统用例图及其分析

![image](https://github.com/SoftwareEngineeringMedical/.github/assets/103842499/b43983e3-7b7b-41ed-87df-faad171e277c)

（1）参与者

用户：使用系统的个人用户，可以执行选择运动方案、记录运动情况、查看历史运动情况等用例。

运动方案智能生成模型：是运动子系统中的一个组件，负责智能生成个性化运动方案。

（2）用例

运动子系统共包括八个用例，分别是：选择运动方案用例、记录运动情况用例、查看健康贴士用例、智能生成个性化运动方案用例、查看历史运动情况用例、月报表用例、周报表用例、日报表用例。

- 选择运动方案：用户可以从系统提供的运动方案中选择适合自己的方案。
- 智能生成个性化运动方案：运动方案智能生成模型根据用户的个人信息自动生成个性化的运动方案。
- 记录运动情况：用户可以记录当前的运动情况，包括日期、运动类型、持续时间和消耗的热量等。
- 查看健康贴士：用户可以查看系统提供的健康贴士。
- 查看历史运动情况：用户可以查看之前运动的历史记录，包括时间、运动类型、持续时间等。
- 月报表：用户可以查看运动子系统生成的月度报表，包括当月的运动统计数据和分析结果。
- 周报表：用户可以查看运动子系统生成的周度报表，包括当周的运动统计数据和分析结果。

- 日报表：用户可以查看运动子系统生成的日度报表，包括当日的运动统计数据和分析结果。

（3）关联关系

用户与选择运动方案、记录运动情况及查看历史运动情况之间存在关联关系，表示用户可以执行这些用例。

运动方案智能生成模型与智能生成个性化运动方案之间存在关联关系，表示运动方案智能生成模型可以执行这个用例。

（4）扩展和包含关系

查看健康贴士用例依赖于记录运动情况用例的执行情况，二者之间是包含关系。

选择运动方案是在智能生成个性化运动方案上生成的新的行为，二者之间是扩展关系。

（5）泛化关系

日报表、周报表和月报表是查看历史运动情况的泛化用例。它们泛化了查看历史运动情况用例，表示用户可选择查看具体某一天的运动情况（日报表）或整个周的运动情况（周报表）或整个月的运动情况（月报表）。

#### 1.3 血糖监测子系统用例图及其分析

![image](https://github.com/SoftwareEngineeringMedical/.github/assets/103842499/2c21b98e-ae04-42f8-acdb-337e6756c7c6)

（1）参与者

用户：使用系统的个人用户，可以执行查看血糖变化情况用例。

血糖仪：血糖监测子系统中的一种设备，用于测量用户的血糖水平。

（2）用例

血糖监测子系统共有五个用例，分别是：查看血糖变化情况用例、监测血糖用例、发出警报用例、智能生成结论用例和记录运动引起的血糖变化用例。

- 查看血糖变化情况用例：用户可以查看血糖水平的变化情况，包括历史记录和数据总结等。
- 记录运动引起的血糖变化用例：用户可以记录和查看运动对血糖水平的影响。
- 智能生成结论用例：系统可以根据用户的血糖数据生成用户的血糖水平占比的情况。
- 监测血糖用例：血糖仪可以实时监测用户的血糖水平，用户也可随时查看自己的血糖水平来形成监测的作用。
- 发出警报用例：当用户的血糖值超出预定值时，系统就会发出警报来提醒用户血糖水平过高。

（3）关联关系

用户与查看血糖变化情况用例之间存在关联关系，说明用户可以执行这个用例。

血糖仪与监测血糖用例之间存在关联关系，说明血糖仪可以执行这个用例。

（4）扩展和包含关系

监测血糖用例依赖于查看血糖变化情况用例的执行情况，二者之间是包含关系。

记录运动引起的血糖变化用例依赖于查看血糖变化情况用例的执行情况，二者之间是包含关系。

智能生成结论是在查看血糖变化情况用例上生成的新的行为，二者之间是拓展关系。

发出警报是监测血糖用例上生成的新的行为，二者之间是拓展关系。

### 三、类图分析
#### 3.1 运动子系统类图及其分析

![ClassDiagram1](https://github.com/SoftwareEngineeringMedical/.github/blob/main/ClassDiagrams/运动管理子系统类图.jpg)

运动子系统共有七个类。

其中最核心的类是运动管理控制器类，这个类是控制整个运动子系统的控制类，它依赖于运动手表接口这个接口类，它可以进行的功能有：生成运动方案、生成运动记录、生成运动历史报告、生成当日运动方案完成状况、生成运动小贴士、传递运动数据等。运动手表接口类是本子系统与外部物理设备运动手表取得联系的接口类，通过这个接口类，本子系统可以获得很多运动手表上的数据，这个类可以进行的操作有：发送运动数据等。除了以上两个类，运动子系统还有两个实体类。

第一个实体类是运动记录实体类，该类记录了与运动记录相关的数据和操作，它与运动管理控制器类形成关联关系，它共有五个属性，分别是：患者ID——记录了患者的ID，开始时间——记录患者此次运动开始的时间，持续时间——记录患者此次运动持续的时间，运动种类——记录患者此次所做运动的种类，运动ID——记录该运动种类所对应的ID；可进行两种操作，分别是查看运动记录和修改运动记录。

第二个实体类是运动方案实体类，这个类主要用于记录和患者的运动方案相关的数据和操作，它与运动管理控制器类形成关联关系，它有四个属性，分别是：患者ID——记录患者的ID，运动种类——记录本运动方案涉及的运动的种类，推荐时长——记录了推荐做运动的时长，方案ID——记录了该运动方案的ID；可进行两种操作，分别是查看运动方案和修改运动方案。

该子系统中还有三个用来处理界面生成的类，分别是运动历史界面类、运动方案界面类和运动中的界面类，这三个类都依赖于运动管理控制器类。其中运动历史界面类主要用来生成和运动历史相关的界面，有：显示总运动历史报告、显示单一运动历史报告、选择查看运动日记录、选择查看运动周记录、选择查看运动月记录、显示运动曲线图等。运动方案界面类主要用来生成和运动方案相关的界面，有：显示推荐运动方案界面、显示当日运动方案完成状况、显示当日运动状态等。运动中的界面类主要用来生成运动中的界面，有：显示运动种类、显示移动速度、显示运动时间、显示消耗卡路里、显示心率和显示运动小贴士等。
#### 3.2 血糖监测子系统类图及其分析

![ClassDiagram2](https://github.com/SoftwareEngineeringMedical/.github/blob/main/ClassDiagrams/血糖检测子系统类图.jpg)
血糖监测子系统共有五个类。

其中，血糖监测管理器这个类是总体控制血糖监测子系统的控制类，它依赖运动接口这个接口类和血糖仪这个接口类，类中所需要用到的很多数据都来自这两个接口类；这个控制类可以进行的功能有：生成血糖曲线图、生成血糖小贴士、提供某点血糖信息、进行血糖占比统计分析等。

而前面提到的运动接口这个类，则是本子系统（即血糖监测子系统）与另一个子系统——运动子系统的接口类，通过这个接口类，本子系统可以与运动子系统取得联系，获得一些需要的数据等；这个接口类可以进行的功能有：获取运动的具体信息等。同样在前面提到的血糖仪类，这也是一个接口类，但它不是本子系统与其他子系统的接口类，而是本子系统与外部物理设备之间的接口类，即与血糖仪这个物理设备之间的接口类，通过这个接口类，本子系统可以获取到和血糖相关的数据；这个接口类可进行的功能有：发送实时血糖等。

除了以上三个类，血糖监测子系统还有一个很重要的实体类——血糖记录类，这个类主要记录了与血糖记录相关的数据和操作，与血糖监测管理器类构成关联关系，它有三个属性，分别是：患者ID——记录患者的ID，血糖值——记录血糖值，记录时间——记录记下某个血糖值时的具体时间；有两个可进行的操作：查看运动记录——查看该患者的运动记录和修改血糖记录——修改该患者的血糖的记录信息。

最后，该子系统还有一个用于处理与血糖记录相关的界面的boundary类，即血糖记录界面类，它依赖于血糖监测管理器类，生成某些血糖记录的页面，有：选择查看血糖日记录、选择查看血糖周记录、选择查看血糖月记录、显示血糖曲线图、显示血糖文本数据、显示实时血糖、显示血糖小贴士、显示血糖统计值、显示血糖曲线上某点的具体信息等等。

### 四、CRC表

| 类：血糖记录界面                   |                |
| ---------------------------------- | -------------- |
| 说明：处理与血糖记录相关的界面的类 |                |
| 职责：                             | 协作者：       |
| 1.选择查看血糖日记录               | 血糖监测管理器 |
| 2.选择查看血糖周记录               |                |
| 3.选择查看血糖月记录               |                |
| 4.显示血糖曲线图                   |                |
| 5.显示血糖文本数据                 |                |
| 6.显示实时血糖                     |                |
| 7.显示血糖小贴士                   |                |
| 8.显示血糖统计值                   |                |
| 9.显示血糖曲线上某点的具体信息     |                |

| 类：血糖监测管理器                   |              |
| ------------------------------------ | ------------ |
| 说明：总体控制血糖监测子系统的控制类 |              |
| 职责：                               | 协作者：     |
| 1.生成血糖曲线图                     | 血糖记录界面 |
| 2.生成血糖小贴士                     | 运动接口     |
| 3.提供某点血糖信息                   | 血糖仪       |
| 4.进行血糖占比统计分析               | 血糖记录     |


| 类：运动接口                       |                |
| ---------------------------------- | -------------- |
| 说明：与运动子系统进行连接的接口类 |                |
| 职责：                             | 协作者：       |
| 1.获取运动的具体信息               | 血糖监测管理器 |

 	 

| 类：血糖仪                     |                |
| ------------------------------ | -------------- |
| 说明：与血糖仪进行连接的接口类 |                |
| 职责：                         | 协作者：       |
| 1.发送实时血糖                 | 血糖监测管理器 |

 	 

| 类：血糖记录                                 |                |
| -------------------------------------------- | -------------- |
| 说明：记录与血糖记录相关的数据和操作的实体类 |                |
| 职责：                                       | 协作者：       |
| 1.查看运动记录                               | 血糖监测管理器 |
| 2.修改血糖记录                               |                |

 	 

| 类：运动历史界面                   |                |
| ---------------------------------- | -------------- |
| 说明：处理与运动历史相关的界面的类 |                |
| 职责：                             | 协作者：       |
| 1.显示总运动历史报告               | 运动管理控制器 |
| 2.显示单一运动历史报告             |                |
| 3.选择查看运动日记录               |                |
| 4.选择查看运动周记录               |                |
| 5.选择查看运动月记录               |                |
| 6.显示运动曲线图                   |                |

| 类：运动方案界面                   |                |
| ---------------------------------- | -------------- |
| 说明：处理与运动方案相关的界面的类 |                |
| 职责：                             | 协作者：       |
| 1.推荐运动方案                     | 运动管理控制器 |
| 2.显示当日运动方案完成状况         |                |
| 3.显示当日运动状况                 |                |

| 类：运动中的界面           |                |
| -------------------------- | -------------- |
| 说明：处理运动中的界面的类 |                |
| 职责：                     | 协作者：       |
| 1.显示运动种类             | 运动管理控制器 |
| 2.显示移动速度             |                |
| 3.显示运动时间             |                |
| 4.显示消耗卡路里           |                |
| 5.显示心率                 |                |
| 6.显示运动小贴士           |                |

| 类：运动手表接口                 |                |
| -------------------------------- | -------------- |
| 说明：与运动手表进行连接的接口类 |                |
| 职责：                           | 协作者：       |
| 1.发送运动数据                   | 运动管理控制器 |


 	 

| 类：运动管理控制器               |              |
| -------------------------------- | ------------ |
| 说明：控制整个运动子系统的控制类 |              |
| 职责：                           | 协作者：     |
| 1.生成运动方案                   | 运动手表接口 |
| 2.生成运动记录                   | 运动方案     |
| 3.生成运动历史报告               | 运动记录     |
| 4.生成日运动方案完成情况         | 用户健康档案 |
| 5.生成运动小贴士                 | 运动历史界面 |
| 6.传递运动数据                   | 运动方案界面 |
|                                  | 运动中的界面 |

| 类：用户健康档案                                 |                |
| ------------------------------------------------ | -------------- |
| 说明：记录与用户健康档案有关的数据与操作的实体类 |                |
| 职责：                                           | 协作者：       |
| 1.查看用户健康档案                               | 运动管理控制器 |
| 2.修改用户健康档案                               |                |

 	 

| 类：运动记录                                 |                |
| -------------------------------------------- | -------------- |
| 说明：记录与运动记录有关的数据和操作的实体类 |                |
| 职责：                                       | 协作者：       |
| 1.查看运动记录                               | 运动管理控制器 |
| 2.修改运动记录                               |                |

 	 

| 类：运动方案                                 |                |
| -------------------------------------------- | -------------- |
| 说明：记录与运动方案相关的数据和操作的实体类 |                |
| 职责：                                       | 协作者：       |
| 1.查看运动方案                               | 运动管理控制器 |
| 2.修改运动方案                               |                |

 	 

### 五、活动图分析
#### 4.1 血糖检测活动图及其分析

![ActivityDiagram3](https://github.com/SoftwareEngineeringMedical/.github/blob/main/ActivityDiagrams/ActivityDiagram3.png)
用户在进入血糖监测子系统后，首先看到的是自己的实时血糖，若用户放大血糖曲线，则会展示某点的具体血糖信息，包括该点所代表的时间点，该时间点的血糖值，及该点的运动情况等。若用户选择查看血糖记录，则系统会接着让用户选择是查看血糖日记录，还是血糖月记录或血糖周记录。若用户选择查看血糖日记录，则系统接下来会要求用户选择想查看的日期。若用户选择的日期在当天往前数的15天之外，则系统会给出该日期血糖数据不可查看的提示；若用户选择的日期在当天往前数的15天之内，则系统会默认展示当天的血糖数据曲线图和血糖数据的总结，用户同样可以通过放大曲线图来查看某点的具体血糖信息；用户还可通过选择查看文本数据来查看当天血糖值的文本记录数据，包括时间点和对应的血糖值。若用户选择查看月记录或周记录，则系统会要求用户选择月份或者周，然后展示出月度血糖报告或周度血糖报告。

#### 4.2 生成运动方案活动图及其分析

![ActivityDiagram1](https://github.com/SoftwareEngineeringMedical/.github/blob/main/ActivityDiagrams/ActivityDiagram1.png)
在生成运动方案时，系统首先会检查用户是否已有运动方案。若患者已经有一个有效的运动方案并想要对这个运动方案进行一些操作，则系统会给出该运动方案，若患者想丢弃该运动方案，则系统会丢弃该运动方案；或者若患者想保留该运动方案，则系统会保留该运动方案。而若患者之前没有运动方案或者其运动方案已经失效了，则系统会获取患者的个人信息，然后根据患者的个人信息，来生成运动方案。生成运动方案的方式有两种，一种是系统自动生成运动方案，并将其添加到患者的日程表中；还有一种是患者手动的添加某种运动方案，在患者添加后，系统会检查改方案是否是有效方案。若方案是有效的，则将其添加到患者的日程表中；若方案是无效的，系统则会让用户尝试重新输入方案。
#### 4.3 运动检测与提醒活动图及其分析

![ActivityDiagram2](https://github.com/SoftwareEngineeringMedical/.github/blob/main/ActivityDiagrams/ActivityDiagram2.png)

在患者进行运动前，系统会检查患者是否满足该项运动的先决条件。若患者当前不适合进行该项运动，则向其展示可以进行运动的先决条件并告知她/他目前不可以运动，然后生成建议，告诉患者怎么做才可以达到运动的先决条件；若患者当前的条件满足运动的先决条件并且患者刚吃过东西，则会给患者生成运动小提示，并开始记录患者运动时的心率和血糖水平。
在患者进行运动的过程中，系统会一直监测用户的心率和血糖值。若患者的血糖值一直处于正常状态，则一直进行记录，直到患者停止该段定期运动，并生成运动报告。而若在运动过程中，系统监测到患者的血糖值处于非正常状态（包括血糖水平过高或血糖水平过低），则持续发出警告报警。若患者的血糖水平过高，则提醒患者结束这种运动，并提醒患者喝水，并在一段时间内，设定该患者不适合该种运动。若患者的血糖水平过低，则提醒患者补充葡萄糖，并提醒其在运动结束后仍自我监测血糖水平，若用户同意自我监测，则读取用户的心率和血糖值，并在一段时间内，设定该用户不适合该种运动。

## 附录C：问题列表
问题列表通常是指在软件开发过程中所遇到的问题或待解决的事项清单。这些问题可能涉及功能性、性能、安全性等方面，团队可以在问题列表中记录并跟踪这些问题的解决过程。
### 1. 问题：如何推荐适合用户的运动方案
解决办法：问卷一共分三步，第一步根据用户的健康档案筛掉不适合运动的人，第二步为能运动的人筛选几个他可能能做的运动（通过这一步确定他是否能进行中高强度的运动），最后一步问的是第二步筛选出的运动的特定禁忌症，通过三步筛选确定出该用户能进行哪些运动。

会在页面上加入免责提醒，让用户更加明确应该对自己的身体负责。

为了保证推荐运动方案的时候是使用最新的健康档案，我们会在推荐之前让用户再确认一遍自己的档案。
### 2. 问题：如何区分低血糖和高血糖的范围
解决办法：我们知道，对于不同年龄的人来说，低血糖、高血糖的范畴是不一样的，比方说对于年轻人来说，血糖为8就已经偏高了。所以我们需要和医生进一步确认。
