## 3. 系统功能

### 3.1 血糖监测与记录

#### 3.1.1 描述

优先级：中

每隔15分钟记录一次血糖，生成当日血糖走势图，并据此给出健康贴士。走势图中有高血糖与低血糖的阈值，可以起到预警的作用。还可以查看历史日、周、月的血糖图或者表格。

####                 ![img](../assets/clip_image002.png)    

####   3.1.2 动机/反应顺序

##### 3.1.2.1. 用户启动血糖监测:

用户佩戴血糖仪并启动血糖监测。

系统每15分钟记录一次数据。

##### 3.1.2.2实时血糖检查:

用户请求实时血糖信息。

系统响应并显示当前血糖水平。

##### 3.1.2.3查看历史数据 - 每日记录:

用户想要查看每日血糖记录。

系统呈现一个用于选择日期的日历。

##### 3.1.2.4选择历史日期 - 在15天内:

用户选择在过去15天内的日期。

系统提供图形（图像模式）或表格（文字模式）表示的选项。

##### 3.1.2.5图形表示 - 图像模式:

用户选择图像模式以图形表示。

系统显示所选日期的趋势图和血糖摘要。

用户可以点击数据点以获取详细信息。

##### 3.1.2.6文本表示 - 文字模式:

用户选择文字模式以表格表示。

系统显示包含时间点和相应血糖值的表格。

##### 3.1.2.7选择历史日期 - 超过15天:

用户尝试选择超过15天的日期。

系统拒绝访问并提供适当的错误消息。

##### 3.1.2.8查看多日记录 - 周和月记录:

用户想要查看多日血糖记录。

系统呈现周和月视图的选项。

##### 3.1.2.9周视图:

用户选择周视图。

系统显示一个用于选择周的日历。

用户选择开始的日期后，系统显示该周的趋势图。

##### 3.1.2.10月视图:

用户选择月视图。

系统显示一个包含12个月的日历。

用户选择一个特定月份后，系统显示该月的趋势图。

#### 3.1.3  功能需求

1. 系统在监测期间必须每15分钟记录一次血糖数据。

1. 用户应能够启动和终止血糖监测。
2. 实时血糖数据必须能够在用户请求时访问。
3. 系统应提供用户友好的日历界面，用于选择历史日期。
4. 图形表示（图像模式）必须包括趋势图和每日摘要。
5. 文本表示（文字模式）必须包括包含时间点和血糖值的表格。
6. 超过15天的历史数据访问必须受到限制，并提供适当的错误消息。
7. 周和月视图应根据用户选择的时间范围显示趋势图。

##### 异常：

1. 系统不能成功获取血糖：记录为缺失/暂时与上一次记录相同/等待下一次血糖出现后进行拟合并提示用户。（TBD）
2. 用户选择日期错误(当前日期之后或者日期过早)：提示用户选择日期错误，如果是日期过早，那么就会显示最早的一次或一组记录；如果是当前日期之后，那么就显示今天对应的日/周/月记录。
3. 选择无数据日期：当日用户并未检测血糖，提示用户无数据。
4. 用户突然中断血糖监测：系统记录中断事件并显示在图标上。
5. 血糖仪故障：系统提示用户血糖仪故障，并让用户尝试重新连接。

### 3.2 运动方案生成

#### 3.2.1 描述

优先级：高

根据用户的健康档案生成运动方案，提醒用户去执行。

####                 ![img](..\assets\clip_image004.png)    

####   3.2.2 动机/反应顺序

##### 3.2.2.1 检测用户计划

1. 系统检测用户是否有现存的运动计划。
2. 如果用户没有现存计划，或计划已过期，或计划不符合期望，系统获取用户的健康档案。
3. 展示手动填写或自动生成选项。

##### 3.2.2.2 用户填写计划

1. 用户选择手动填写计划。
2. 用户完成填写后，系统检测计划的合理性。
3. 新计划添加到日程:

##### 3.2.2.3 自动生成计划

1. 用户选择自动生成计划。
2. 系统生成多个计划，用户选择其中一个。
3. 新计划添加到日程:

##### 3.2.2.4 对原有计划操作

1. 如果用户有有效计划且想手动调整，系统获取当前计划。
2. 系统给出保留计划、放弃计划、延长计划三个选项。
3. 用户选择其中保留、放弃、延长计划，计划就会被保留、放弃、延长1周。

#### 3.2.3  功能需求

**1.**   系统必须提供手动和自动计划创建的选项。

**2.**   在手动创建计划时，系统必须提示用户输入详细信息，如运动类型、持续时间和强度。

**3.**   在自动生成计划时，系统必须考虑用户的健康档案和偏好。

**4.**   系统必须验证手动输入计划的可行性和适当性。

**5.**   系统必须显示生成的计划供用户选择。

**6.**   用户必须能够将所选计划添加到其日程中。

##### 异常

1. 手动填写计划合理性检测异常。系统会提供清晰的错误信息，指导用户检查并修改不合理的计划。系统还可以提供一些建议来改进计划。
2. 自动生成计划不符合用户预期，提供用户评估生成的计划的选项，并允许用户选择或调整计划。系统可以收集反馈以改进自动生成计划的算法。（TBD）

### 3.3   运动记录

#### 3.3.1 描述

​    优先级：高

​    检测用户是否符合锻炼的条件，在记录锻炼数据的同时监测血糖。

#### 3.3.2 动机/生成顺序

1. 检测是否符合前提条件并且在饭后。

​    2. 系统进入运动模式，记录心跳与血糖。

​    3. 正常血糖时，周期性地（每3分钟）记录。

​    4. 生成运动报告，包括血糖、心率、速度、种类、异常情况、运动计划进度(如果有)等等。

#### 3.3.3 功能需求

1. 根据用户的健康档案和先前的运动计划，系统应检测用户是否符合进行饭后运动的前提条件。
2. 在正常血糖情况下，系统应每3分钟记录一次心跳率、血糖水平等数据。
3. 在运动结束后，系统应生成详细的运动报告，包括血糖水平、心跳率、运动速度、运动种类等信息。
4. 如果用户有运动计划，报告中应包含运动计划的进度。
5. 报告中应标识任何异常情况，如血糖异常或心跳异常。
6. 界面应清晰显示运动报告和运动计划。
7. 用户应能够手动触发运动模式或暂停运动记录。

##### 异常

1. 不符合运动的前提条件，展示前提条件并提示哪些条件不符，给出相应的建议。
2. 运动途中高血糖或低血糖，系统发出警报。
3. 运动途中高血糖，应该提醒立即停止运动并补水。
4. 运动途中低血糖，提醒补充葡萄糖，并提醒进行血糖与心率的自我监测。
5. 超出运动计划要求的频率、方式、强度等等，系统提醒用户合理计划。
6. 无法连接血糖仪，提醒用户多尝试连接几次血糖仪。

## 5. 外部接口需求

### 5.1 用户接口

 

### 5.2   软件接口

 

### 5.3   硬件接口

 

 

### 5.4 通信接口